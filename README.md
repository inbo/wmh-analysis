# wmh-analysis
## Rationale
This repository contains the R code developped for the research paper on migration patterns of Western Marsh Harriers 
(*'Contrasting migration strategies between nearby breeding populations of Marsh Harrier* Circus aeruginosus 
*using the West African-Eurasian flyway'*) by Wouter Vansteelant et al.

In this paper, GPS tracking data were used to study the wintering migration patterns of *Circus aeruginosus* of 3 breeding populations: 
1. near the Belgian-Dutch border in the provinces East-Flanders (Belgium) and Zeeland (the Netherlands) (4 tracked birds, 
data collection by [INBO](www.inbo.be/en) as part of the Flemish contribution to the [LifeWatch](www.lifewatch.be) observatory), 
2. in the province of Groningen (the Netherlands) (2 tracked birds, data collection by 
[Dutch MontaguÂ´s Harrier Foundation](http://werkgroepgrauwekiekendief.nl/)), and
3. southern Sweden (4 tracked birds, data collection by [Lund University](https://www.lunduniversity.lu.se/)).


## Repo structure

```
|-- data                <- Data used in this analysis
    |--maps             <- Maps downloaded by the scripts, to be ignored by git
|-- reports             <- Output generated by the scripts, to be ignored by git
    |-- figures         <- Figures generated by the scripts, to be ignored by git
    |-- tables          <- Tables (.csv) generated by the scripts, to be ignored by git
|-- src                 <- Scripts generated for this analysis
|-- gitignore           <- Files and directories to be ignored by git
|-- LICENSE             <- Repository license
|-- README.md           <- Description of this repository
|-- wmh-analysis.Rproj  <- R project file for this repository
```


## Getting started
### Packages
In order to run the scripts properly, the installation of the following R-packages is required:

* car
* circular
* emmeans
* fossil
* ggplot2
* gridExtra
* here
* lattice
* lme4
* lubridate
* maptools
* MASS
* raster
* RColorBrewer
* readr
* reshape2
* rgdal
* sp
* zoo


### Data
#### Project data (accessible in this repo)
* annotation.csv: annotated version of the Belgian and Dutch dataset. Wouter Vansteelant determined the start and end dates of migratory and non-migratory periods through expert interpretation of tracks in Google Earth.
    * Bird name [`name`]
	* Migratory cycle [`cycle`] (winter, spring, summer, autumn + year)
	* Starting date [`date`]
    * Behaviour type [`type`] (breeding, dead, migration, move, pre-migration, winter.stage1, winter.stage2, winter.stage3)
    * Criteria for selection in analysis ([`complete`], [`use.date`])
* annotation-swedes.csv: annotated version of the Swedish dataset. Wouter Vansteelant determined the start and end dates of migratory and non-migratory periods through expert interpretation of tracks in Google Earth.
    * Bird name [`name`]
	* Migratory cycle [`cycle`] (winter, spring, summer, autumn + year)
	* Starting date [`date`]
    * Behaviour type [`type`] (breeding, dead, migration, move, pre-migration, winter.stage1, winter.stage2)
    * Criteria for selection in analysis ([`complete`], [`use.date`])
* MH-resampled-23092017.csv: Belgian and Dutch tracking data downloaded from the UvA-BiTS database on September 23rd, 2017
* swedes.csv: Swedish tracking data
* weather.csv: daily tailwind conditions calculated using the method of [Klaassen et al. (2010)](https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1600-048X.2010.05058.x). u- and v-wind components were obtained from the NOAA NCEP global atmospheric reanalysis model.

#### External GIS data (available through web links)
* ne_50m_admin_0_countries: shapefile containing country boundaries, source: Natural Earth ( https://www.naturalearthdata.com/downloads/50m-cultural-vectors/50m-admin-0-countries-2/)
* alt_30s_bil: raster file containing a DEM of the world, source: worldclim, version 1.4 (http://biogeo.ucdavis.edu/data/climate/worldclim/1_4/grid/cur/alt_30s_bil.zip)

## Workflow

